var app=function(){"use strict";function t(){}function e(t,e){for(var n in e)t[n]=e[n];return t}function n(t,e){return 0===e&&t(),()=>{--e||t()}}function o(t){t()}function r(t,e){t.appendChild(e)}function a(t,e,n){t.insertBefore(e,n)}function i(t){t.parentNode.removeChild(t)}function s(t,e){for(var n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function l(){return document.createDocumentFragment()}function c(t){return document.createElement(t)}function d(t){return document.createTextNode(t)}function u(){return document.createComment("")}function b(t,e,n,o){t.addEventListener(e,n,o)}function f(t,e,n,o){t.removeEventListener(e,n,o)}function h(t,e,n){null==n?t.removeAttribute(e):t.setAttribute(e,n)}function y(t,e){t.data=""+e}function m(t,e,n){t.style.setProperty(e,n)}function g(t,e){for(var n=0;n<t.options.length;n+=1){var o=t.options[n];if(o.__value===e)return void(o.selected=!0)}}function _(t){var e=t.querySelector(":checked")||t.options[0];return e&&e.__value}function p(){return Object.create(null)}function v(t){t._lock=!0,j(t._beforecreate),j(t._oncreate),j(t._aftercreate),t._lock=!1}function k(t,e){t._handlers=p(),t._slots=p(),t._bind=e._bind,t._staged={},t.options=e,t.root=e.root||t,t.store=e.store||t.root.store,e.root||(t._beforecreate=[],t._oncreate=[],t._aftercreate=[])}function j(t){for(;t&&t.length;)t.shift()()}var N={destroy:function(e){this.destroy=t,this.fire("destroy"),this.set=t,this._fragment.d(!1!==e),this._fragment=null,this._state={}},get:function(){return this._state},fire:function(t,e){var n=t in this._handlers&&this._handlers[t].slice();if(n)for(var o=0;o<n.length;o+=1){var r=n[o];if(!r.__calling)try{r.__calling=!0,r.call(this,e)}finally{r.__calling=!1}}},on:function(t,e){var n=this._handlers[t]||(this._handlers[t]=[]);return n.push(e),{cancel:function(){var t=n.indexOf(e);~t&&n.splice(t,1)}}},set:function(t){this._set(e({},t)),this.root._lock||v(this.root)},_recompute:t,_set:function(t){var n=this._state,o={},r=!1;for(var a in t=e(this._staged,t),this._staged={},t)this._differs(t[a],n[a])&&(o[a]=r=!0);r&&(this._state=e(e({},n),t),this._recompute(o,this._state),this._bind&&this._bind(o,this._state),this._fragment&&(this.fire("state",{changed:o,current:this._state,previous:n}),this._fragment.p(o,this._state),this.fire("update",{changed:o,current:this._state,previous:n})))},_stage:function(t){e(this._staged,t)},_mount:function(t,e){this._fragment[this._fragment.i?"i":"m"](t,e||null)},_differs:function(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}};function O(t){k(this,t),this._state=e({select:"0"},t.data),this._intro=!!t.intro,this._fragment=function(t,e){var n,s,l,u,m;function g(n){t.fire("click",{color:e.color})}return{c(){n=c("div"),s=c("span"),l=d(e.label),s.className="svelte-xc3qo4",b(n,"click",g),n.className=u="Button "+e.color+" "+("1"==e.select?"select":"")+" svelte-xc3qo4",h(n,"test",e.select)},m(t,e){a(t,n,e),r(n,s),r(s,l),m=!0},p(t,o){e=o,t.label&&y(l,e.label),(t.color||t.select)&&u!==(u="Button "+e.color+" "+("1"==e.select?"select":"")+" svelte-xc3qo4")&&(n.className=u),t.select&&h(n,"test",e.select)},i(t,e){m||this.m(t,e)},o:o,d(t){t&&i(n),f(n,"click",g)}}}(this,this._state),t.target&&(this._fragment.c(),this._mount(t.target,t.anchor)),this._intro=!0}function S(n){var s,l,d,u;k(this,n),this._state=e({},n.data),this._intro=!!n.intro,this._slotted=n.slots||{},this._fragment=(s=this,this._state,u=s._slotted.default,{c(){(l=c("div")).className="Buttons svelte-mmcuhn"},m(t,e){a(t,l,e),u&&r(l,u),d=!0},p:t,i(t,e){d||this.m(t,e)},o:o,d(t){t&&i(l),u&&function(t,e){for(;t.firstChild;)e.appendChild(t.firstChild)}(l,u)}}),n.target&&(this._fragment.c(),this._mount(n.target,n.anchor)),this._intro=!0}function x(t){k(this,t),this._state=e(e({JSON:JSON},{JSONminify:!1}),t.data),this._intro=!!t.intro,this._fragment=function(t,e){var n,s,l,u,m,g,_,p,v=e.JSON.stringify(e.keyboard,"",e.JSONminify?0:2);function k(){t.set({JSONminify:s.checked})}return{c(){n=c("div"),s=c("input"),l=d("\n\t"),(u=c("label")).textContent="JSON minify",m=d("\n\n\n"),g=c("pre"),_=d(v),b(s,"change",k),h(s,"type","checkbox"),u.className="svelte-vtlwtn",n.className="Rows svelte-vtlwtn"},m(t,o){a(t,n,o),r(n,s),s.checked=e.JSONminify,r(n,l),r(n,u),a(t,m,o),a(t,g,o),r(g,_),p=!0},p(t,e){t.JSONminify&&(s.checked=e.JSONminify),(t.JSON||t.keyboard||t.JSONminify)&&v!==(v=e.JSON.stringify(e.keyboard,"",e.JSONminify?0:2))&&y(_,v)},i(t,e){p||this.m(t,e)},o:o,d(t){t&&i(n),f(s,"change",k),t&&(i(m),i(g))}}}(this,this._state),t.target&&(this._fragment.c(),this._mount(t.target,t.anchor)),this._intro=!0}function J({keyboard:t}){return function(t){let e="";e+='// import "encoding/json"\n',e+='\n// Структуры\n\ntype keyboardButtonAction struct {\n\tLabel   string `json:"label,omitempty"`\n\tPayload string `json:"payload,omitempty"`\n\tType    string `json:"type"`\n}\n\ntype keyboardButton struct {\n\tAction keyboardButtonAction `json:"action"`\n\tColor  string               `json:"color"`\n}\n\ntype keyboardRow []keyboardButton\n\ntype keyboard struct {\n\tButtons []keyboardRow `json:"buttons"`\n\tOneTime bool          `json:"one_time"`\n}\n\n// Основной код\n\nvar buttons []keyboardRow\nvar button keyboardButton\nvar buttonAction keyboardButtonAction\n\n\n',console.log(t);for(let n=0;n<t.buttons.length;n++){const o=t.buttons[n];e+=`var row${n} []keyboardButton\n`,o.forEach(t=>{e+=`\nbuttonAction = keyboardButtonAction{\n\tLabel:   "${t.action.label.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}",\n\tPayload: "${t.action.payload.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}",\n\tType:    "${t.action.type}",\n}\nbutton = keyboardButton{\n\tAction: buttonAction,\n\tColor:  "${t.color}",\n}\n\nrow${n} = append(row${n}, button)\n`}),e+=`buttons = append(buttons, row${n})\n`}return e+=`\nkb := keyboard{\n\tButtons: buttons,\n\tOneTime: ${t.one_time},\n}\n\nbyteJSON, _ := json.Marshal(kb)\nkeyboardJSON := string(byteJSON)\n\n// fmt.Print(keyboardJSON)`}(t)}function C(t){var n,s,l,u;k(this,t),this._state=e({},t.data),this._recompute({keyboard:1},this._state),this._intro=!!t.intro,this._fragment=(n=this._state,{c(){s=c("pre"),l=d(n.code)},m(t,e){a(t,s,e),r(s,l),u=!0},p(t,e){t.code&&y(l,e.code)},i(t,e){u||this.m(t,e)},o:o,d(t){t&&i(s)}}),t.target&&(this._fragment.c(),this._mount(t.target,t.anchor)),this._intro=!0}function $({keyboard:t}){return function(t){let e="";e+='// import "encoding/json"\n',e+="\n// Код для github.com/SevereCloud/vksdk\n\nvar kb object.MessagesKeyboard\n\n\n",console.log(t);for(let n=0;n<t.buttons.length;n++){const o=t.buttons[n];e+="\nkb.AddRow()\n",o.forEach(t=>{e+="kb.AddButton("+`"${t.action.label.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}", `+`"${t.action.payload.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}", `+`"${t.color}"`+")\n"})}return e+="\nbyteJSON, _ := json.Marshal(kb)\nkeyboardJSON := string(byteJSON)\n\n// fmt.Print(keyboardJSON)"}(t)}function w(t){var n,s,l,u;k(this,t),this._state=e({},t.data),this._recompute({keyboard:1},this._state),this._intro=!!t.intro,this._fragment=(n=this._state,{c(){s=c("pre"),l=d(n.code)},m(t,e){a(t,s,e),r(s,l),u=!0},p(t,e){t.code&&y(l,e.code)},i(t,e){u||this.m(t,e)},o:o,d(t){t&&i(s)}}),t.target&&(this._fragment.c(),this._mount(t.target,t.anchor)),this._intro=!0}e(O.prototype,N),e(S.prototype,N),e(x.prototype,N),e(C.prototype,N),C.prototype._recompute=function(t,e){t.keyboard&&this._differs(e.code,e.code=J(e))&&(t.code=!0)},e(w.prototype,N),w.prototype._recompute=function(t,e){t.keyboard&&this._differs(e.code,e.code=$(e))&&(t.code=!0)};var B={updateColor(t){const{keyboard:e,i:n,j:o}=this.get();e.buttons[n][o].color=t,this.set({keyboard:e})},addRow(){const{keyboard:t,i:e,j:n}=this.get();let o=t.buttons.length;o<10&&(t.buttons[o]=[{action:{type:"text",payload:'{"button": "1"}',label:"Label"},color:"default"}]),this.set({keyboard:t,i:o,j:0})},addColumn(t){const{keyboard:e,i:n,j:o}=this.get();let r=e.buttons[t].length;r<4&&(e.buttons[t][r]={action:{type:"text",payload:'{"button": "1"}',label:"Label"},color:"default"}),this.set({keyboard:e,i:t,j:r})},removeButton(){const{keyboard:t,i:e,j:n}=this.get();let o=e,r=n,a=t.buttons.length,i=t.buttons[0].length;console.log(a,i),(a>1||i>1)&&(t.buttons[e].splice(n,1),0==t.buttons[e].length?(t.buttons.splice(e,1),e>0&&(o=e-1),r=t.buttons[o].length-1):n>0&&(r=n-1)),this.set({keyboard:t,i:o,j:r})}};function A(t,e,n){const o=Object.create(t);return o.color=e[n],o}function P(t){const{component:e,ctx:n}=this._svelte;e.addColumn(n.ii)}function V(t,e,n){const o=Object.create(t);return o.button=e[n],o.jj=n,o}function G(t,e,n){const o=Object.create(t);return o.buttons=e[n],o.ii=n,o}function L(t,e){var n,o={label:e.button.action.label,color:e.button.color,select:e.i==e.ii&&e.j==e.jj?"1":"0"},r=new O({root:t.root,store:t.store,data:o});return r.on("click",function(n){t.set({i:e.ii,j:e.jj})}),{c(){r._fragment.c()},m(t,e){r._mount(t,e),n=!0},p(t,n){e=n;var o={};t.keyboard&&(o.label=e.button.action.label),t.keyboard&&(o.color=e.button.color),(t.i||t.j)&&(o.select=e.i==e.ii&&e.j==e.jj?"1":"0"),r._set(o)},i(t,e){n||this.m(t,e)},o(t){n&&(r&&r._fragment.o(t),n=!1)},d(t){r.destroy(t)}}}function R(t,e){var n;return{c(){(n=c("div")).textContent="+",n._svelte={component:t,ctx:e},b(n,"click",P),n.className="button-add svelte-1egbdsg"},m(t,e){a(t,n,e)},p(t,o){e=o,n._svelte.ctx=e},d(t){t&&i(n),f(n,"click",P)}}}function T(t,e){for(var o,b,f,h,y=e.buttons,m=[],g=0;g<y.length;g+=1)m[g]=L(t,V(e,y,g));function _(t,e,n){m[t]&&m[t].o(()=>{e&&(m[t].d(e),m[t]=null),n&&n()})}var p=new S({root:t.root,store:t.store,slots:{default:l()}}),v=e.keyboard.buttons[e.ii].length<4&&R(t,e);return{c(){o=c("div");for(var t=0;t<m.length;t+=1)m[t].c();b=u(),p._fragment.c(),f=d("\n\t\t\t"),v&&v.c(),o.className="row svelte-1egbdsg"},m(t,e){a(t,o,e);for(var n=0;n<m.length;n+=1)m[n].i(p._slotted.default,null);r(p._slotted.default,b),p._mount(o,null),r(o,f),v&&v.m(o,null),h=!0},p(e,n){if(e.keyboard||e.i||e.j){y=n.buttons;for(var r=0;r<y.length;r+=1){const o=V(n,y,r);m[r]?m[r].p(e,o):(m[r]=L(t,o),m[r].c()),m[r].i(b.parentNode,b)}for(;r<m.length;r+=1)_(r,1)}n.keyboard.buttons[n.ii].length<4?v||((v=R(t,n)).c(),v.m(o,null)):v&&(v.d(1),v=null)},i(t,e){h||this.m(t,e)},o(t){if(!h)return;t=n(t,2);const e=n(t,(m=m.filter(Boolean)).length);for(let t=0;t<m.length;t+=1)_(t,0,e);p&&p._fragment.o(t),h=!1},d(t){t&&i(o),s(m,t),p.destroy(),v&&v.d()}}}function E(t,e){var n;function o(e){t.addRow()}return{c(){(n=c("div")).textContent="Добавить",b(n,"click",o),n.className="button-add svelte-1egbdsg"},m(t,e){a(t,n,e)},d(t){t&&i(n),f(n,"click",o)}}}function M(t,e){var n;return{c(){(n=c("b")).textContent="Пустой текст!",n.className="note svelte-1egbdsg",m(n,"color","#db3b3b")},m(t,e){a(t,n,e)},d(t){t&&i(n)}}}function q(t,e){var n;return{c(){(n=c("b")).textContent="Слишком много символов!",n.className="note svelte-1egbdsg",m(n,"color","#db3b3b")},m(t,e){a(t,n,e)},d(t){t&&i(n)}}}function H(t,e){var n;return{c(){(n=c("b")).textContent="Невалидный JSON!",n.className="note svelte-1egbdsg",m(n,"color","#db3b3b")},m(t,e){a(t,n,e)},d(t){t&&i(n)}}}function I(t,e){var n,o={label:e.keyboard.buttons[e.i][e.j].color==e.color?"X":"",color:e.color},r=new O({root:t.root,store:t.store,data:o});return r.on("click",function(e){t.updateColor(e.color)}),{c(){r._fragment.c()},m(t,e){r._mount(t,e),n=!0},p(t,e){var n={};(t.keyboard||t.i||t.j)&&(n.label=e.keyboard.buttons[e.i][e.j].color==e.color?"X":""),r._set(n)},i(t,e){n||this.m(t,e)},o(t){n&&(r&&r._fragment.o(t),n=!1)},d(t){r.destroy(t)}}}function K(t,e){var n,o,s,l,h,y,m,p,v,k=!1;function j(){k=!0,t.set({select:_(n)}),k=!1}var N=[W,F,D],O=[];function S(t){return"JSON"==t.select?0:"Golang"==t.select?1:"Golang-vksdk"==t.select?2:-1}return~(y=S(e))&&(m=O[y]=N[y](t,e)),{c(){n=c("select"),(o=c("option")).textContent="JSON",(s=c("option")).textContent="Golang",(l=c("option")).textContent="Golang vksdk",h=d("\n\n    "),m&&m.c(),p=u(),o.__value="JSON",o.value=o.__value,s.__value="Golang",s.value=s.__value,l.__value="Golang-vksdk",l.value=l.__value,b(n,"change",j),"select"in e||t.root._beforecreate.push(j),n.className="header svelte-1egbdsg"},m(t,i){a(t,n,i),r(n,o),r(n,s),r(n,l),g(n,e.select),a(t,h,i),~y&&O[y].m(t,i),a(t,p,i),v=!0},p(e,o){!k&&e.select&&g(n,o.select);var r=y;(y=S(o))===r?~y&&O[y].p(e,o):(m&&m.o(function(){O[r].d(1),O[r]=null}),~y?((m=O[y])||(m=O[y]=N[y](t,o)).c(),m.m(p.parentNode,p)):m=null)},i(t,e){v||this.m(t,e)},o(t){v&&(m?m.o(t):t(),v=!1)},d(t){t&&i(n),f(n,"change",j),t&&i(h),~y&&O[y].d(t),t&&i(p)}}}function X(t,e){var n,s,l,u,b;return{c(){(n=c("h3")).textContent="Ошибки",s=d("\n    "),l=c("pre"),u=d(e.errorValid)},m(t,e){a(t,n,e),a(t,s,e),a(t,l,e),r(l,u),b=!0},p(t,e){t.errorValid&&y(u,e.errorValid)},i(t,e){b||this.m(t,e)},o:o,d(t){t&&(i(n),i(s),i(l))}}}function D(t,e){var n,o={keyboard:e.keyboard},r=new w({root:t.root,store:t.store,data:o});return{c(){r._fragment.c()},m(t,e){r._mount(t,e),n=!0},p(t,e){var n={};t.keyboard&&(n.keyboard=e.keyboard),r._set(n)},i(t,e){n||this.m(t,e)},o(t){n&&(r&&r._fragment.o(t),n=!1)},d(t){r.destroy(t)}}}function F(t,e){var n,o={keyboard:e.keyboard},r=new C({root:t.root,store:t.store,data:o});return{c(){r._fragment.c()},m(t,e){r._mount(t,e),n=!0},p(t,e){var n={};t.keyboard&&(n.keyboard=e.keyboard),r._set(n)},i(t,e){n||this.m(t,e)},o(t){n&&(r&&r._fragment.o(t),n=!1)},d(t){r.destroy(t)}}}function W(t,e){var n,o={keyboard:e.keyboard},r=new x({root:t.root,store:t.store,data:o});return{c(){r._fragment.c()},m(t,e){r._mount(t,e),n=!0},p(t,e){var n={};t.keyboard&&(n.keyboard=e.keyboard),r._set(n)},i(t,e){n||this.m(t,e)},o(t){n&&(r&&r._fragment.o(t),n=!1)},d(t){r.destroy(t)}}}function z(t){k(this,t),this._state=e({},t.data),this._recompute({keyboard:1,i:1,j:1},this._state),this._intro=!!t.intro,this._fragment=function(t,e){for(var o,y,m,g,_,p,v,k,j,N,O,x,J,C,$,w,B,P,V,L,R,D,F,W,z,Q,U,Y,Z,tt,et,nt,ot,rt,at,it,st,lt,ct,dt,ut,bt=!1,ft=!1,ht=e.keyboard.buttons,yt=[],mt=0;mt<ht.length;mt+=1)yt[mt]=T(t,G(e,ht,mt));function gt(t,e,n){yt[t]&&yt[t].o(()=>{e&&(yt[t].d(e),yt[t]=null),n&&n()})}var _t=e.keyboard.buttons.length<10&&E(t);function pt(){bt=!0,e.keyboard.buttons[e.i][e.j].action.label=B.value,t.set({keyboard:e.keyboard,i:e.i,j:e.j}),bt=!1}var vt=""===e.keyboard.buttons[e.i][e.j].action.label&&M(),kt=e.keyboard.buttons[e.i][e.j].action.label.length>41&&q();function jt(){ft=!0,e.keyboard.buttons[e.i][e.j].action.payload=W.value,t.set({keyboard:e.keyboard,i:e.i,j:e.j}),ft=!1}var Nt=!e.validPayload&&H(),Ot=["primary","default","negative","positive"],St=[];for(mt=0;mt<Ot.length;mt+=1)St[mt]=I(t,A(e,Ot,mt));function xt(t,e,n){St[t]&&St[t].o(()=>{e&&(St[t].d(e),St[t]=null),n&&n()})}var Jt=new S({root:t.root,store:t.store,slots:{default:l()}});function Ct(e){t.removeButton()}function $t(){e.keyboard.one_time=at.checked,t.set({keyboard:e.keyboard})}var wt=[X,K],Bt=[];function At(t){return t.errorValid?0:1}return ct=At(e),dt=Bt[ct]=wt[ct](t,e),{c(){o=c("div"),(y=c("h1")).textContent="Генератор клавиатуры для VK",m=d("\n\t\n  "),(g=c("p")).innerHTML='\n\t\t\t\t\tГенерирует <a href="https://vk.com/dev/bots_docs_3">клавиатуру</a> для ботов. \n\t\t\t    Проверить клавиатуру можно отправив JSON <a href="https://vk.com/im?sel=-174472256">боту</a>.\n\t\t\t\t',_=d("\n  "),(p=c("p")).innerHTML='<a href="https://github.com/severecloud/vk-keyboard">GitHub</a>',v=d("\n\n  "),(k=c("h3")).textContent="Клавиатура",j=d("\n\n\t"),N=c("div");for(var t=0;t<yt.length;t+=1)yt[t].c();for(O=d(" \n    "),_t&&_t.c(),x=d("\n\n    "),J=c("div"),C=c("div"),($=c("label")).textContent="Текст",w=d("\n        "),B=c("input"),P=d("\n        "),vt&&vt.c(),V=d("\n        "),kt&&kt.c(),L=d("\n\n      "),R=c("div"),(D=c("label")).textContent="Полезная нагрузка",F=d("\n        "),W=c("input"),z=d(" \n        "),Nt&&Nt.c(),Q=d("\n\n      "),U=c("div"),(Y=c("label")).textContent="Цвет",Z=d("\n        "),t=0;t<St.length;t+=1)St[t].c();tt=u(),Jt._fragment.c(),et=d("\n\n      "),(nt=c("div")).textContent="Удалить",ot=d("\n\n    "),rt=c("div"),at=c("input"),it=d("\n      "),(st=c("label")).textContent="скрывать клавиатуру сразу",lt=d("\n\n  "),dt.c(),$.className="svelte-1egbdsg",b(B,"input",pt),h(B,"type","text"),C.className="block-item svelte-1egbdsg",D.className="svelte-1egbdsg",b(W,"input",jt),h(W,"type","text"),R.className="block-item svelte-1egbdsg",Y.className="svelte-1egbdsg",U.className="block-item svelte-1egbdsg",b(nt,"click",Ct),nt.className="button-remove svelte-1egbdsg",J.className="border svelte-1egbdsg",b(at,"change",$t),h(at,"type","checkbox"),st.className="svelte-1egbdsg",rt.className="one-time svelte-1egbdsg",N.className="buttons-main svelte-1egbdsg",o.className="main svelte-1egbdsg"},m(t,n){a(t,o,n),r(o,y),r(o,m),r(o,g),r(o,_),r(o,p),r(o,v),r(o,k),r(o,j),r(o,N);for(var i=0;i<yt.length;i+=1)yt[i].i(N,null);for(r(N,O),_t&&_t.m(N,null),r(N,x),r(N,J),r(J,C),r(C,$),r(C,w),r(C,B),B.value=e.keyboard.buttons[e.i][e.j].action.label,r(C,P),vt&&vt.m(C,null),r(C,V),kt&&kt.m(C,null),r(J,L),r(J,R),r(R,D),r(R,F),r(R,W),W.value=e.keyboard.buttons[e.i][e.j].action.payload,r(R,z),Nt&&Nt.m(R,null),r(J,Q),r(J,U),r(U,Y),r(U,Z),i=0;i<St.length;i+=1)St[i].i(Jt._slotted.default,null);r(Jt._slotted.default,tt),Jt._mount(U,null),r(J,et),r(J,nt),r(N,ot),r(N,rt),r(rt,at),at.checked=e.keyboard.one_time,r(rt,it),r(rt,st),r(o,lt),Bt[ct].m(o,null),ut=!0},p(n,r){if(e=r,n.keyboard||n.i||n.j){ht=e.keyboard.buttons;for(var a=0;a<ht.length;a+=1){const o=G(e,ht,a);yt[a]?yt[a].p(n,o):(yt[a]=T(t,o),yt[a].c()),yt[a].i(N,O)}for(;a<yt.length;a+=1)gt(a,1)}if(e.keyboard.buttons.length<10?_t||((_t=E(t)).c(),_t.m(N,x)):_t&&(_t.d(1),_t=null),!bt&&(n.keyboard||n.i||n.j)&&(B.value=e.keyboard.buttons[e.i][e.j].action.label),""===e.keyboard.buttons[e.i][e.j].action.label?vt||((vt=M()).c(),vt.m(C,V)):vt&&(vt.d(1),vt=null),e.keyboard.buttons[e.i][e.j].action.label.length>41?kt||((kt=q()).c(),kt.m(C,null)):kt&&(kt.d(1),kt=null),!ft&&(n.keyboard||n.i||n.j)&&(W.value=e.keyboard.buttons[e.i][e.j].action.payload),e.validPayload?Nt&&(Nt.d(1),Nt=null):Nt||((Nt=H()).c(),Nt.m(R,null)),n.keyboard||n.i||n.j){for(Ot=["primary","default","negative","positive"],a=0;a<Ot.length;a+=1){const o=A(e,Ot,a);St[a]?St[a].p(n,o):(St[a]=I(t,o),St[a].c()),St[a].i(tt.parentNode,tt)}for(;a<St.length;a+=1)xt(a,1)}n.keyboard&&(at.checked=e.keyboard.one_time);var i=ct;(ct=At(e))===i?Bt[ct].p(n,e):(dt.o(function(){Bt[i].d(1),Bt[i]=null}),(dt=Bt[ct])||(dt=Bt[ct]=wt[ct](t,e)).c(),dt.m(o,null))},i(t,e){ut||this.m(t,e)},o(t){if(!ut)return;t=n(t,4);const e=n(t,(yt=yt.filter(Boolean)).length);for(let t=0;t<yt.length;t+=1)gt(t,0,e);const o=n(t,(St=St.filter(Boolean)).length);for(let t=0;t<St.length;t+=1)xt(t,0,o);Jt&&Jt._fragment.o(t),dt?dt.o(t):t(),ut=!1},d(t){t&&i(o),s(yt,t),_t&&_t.d(),f(B,"input",pt),vt&&vt.d(),kt&&kt.d(),f(W,"input",jt),Nt&&Nt.d(),s(St,t),Jt.destroy(),f(nt,"click",Ct),f(at,"change",$t),Bt[ct].d()}}}(this,this._state),t.target&&(this._fragment.c(),this._mount(t.target,t.anchor),v(this)),this._intro=!0}e(z.prototype,N),e(z.prototype,B),z.prototype._recompute=function(t,e){(t.keyboard||t.i||t.j)&&this._differs(e.validPayload,e.validPayload=function({keyboard:t,i:e,j:n}){let o,r=t.buttons[e][n].action.payload;try{o=JSON.parse(r)}catch(t){return!1}return(t=>t instanceof Object&&!Array.isArray(t))(o)&&0!=Object.keys(o).length&&r.length<256}(e))&&(t.validPayload=!0),t.keyboard&&this._differs(e.errorValid,e.errorValid=function({keyboard:t}){let e="";for(let n=0;n<t.buttons.length;n++){const o=t.buttons[n];for(let t=0;t<o.length;t++){const r=o[t];""==r.action.label&&(e+=`${n+1}:${t+1} пустой текст\n`),r.action.label.length>41&&(e+=`${n+1}:${t+1} больше 40 символов в тексте\n`);let a,i=t=>t instanceof Object&&!Array.isArray(t),s=r.action.payload;try{i(a=JSON.parse(s))||(e+=`${n+1}:${t+1} требуется объект в json вида {"button": 1}\n`),0==Object.keys(a).length&&(e+=`${n+1}:${t+1} пустой объект в json\n`),s.length>255&&(e+=`${n+1}:${t+1} больше 255 символов в json\n`)}catch(o){e+=`${n+1}:${t+1} невалидный json\n`}}}return localStorage.setItem("keyboard",JSON.stringify(t)),e}(e))&&(t.errorValid=!0)};var Q=localStorage.getItem("keyboard");if(Q)var U=JSON.parse(Q);else U={one_time:!1,buttons:[[{action:{type:"text",payload:'{"button": "1"}',label:"Red"},color:"negative"},{action:{type:"text",payload:'{"button": "2"}',label:"Green"},color:"positive"}],[{action:{type:"text",payload:'{"button": "3"}',label:"White"},color:"default"},{action:{type:"text",payload:'{"button": "4"}',label:"Blue"},color:"primary"}]]};return new z({target:document.body,data:{keyboard:U,i:0,j:0,errorValid:"",select:"JSON"}})}();
//# sourceMappingURL=bundle.js.map
