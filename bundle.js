var app=function(){"use strict";function t(){}function e(t,e){for(var n in e)t[n]=e[n];return t}function n(t,e){return 0===e&&t(),()=>{--e||t()}}function o(t){t()}function r(t,e){t.appendChild(e)}function a(t,e,n){t.insertBefore(e,n)}function i(t){t.parentNode.removeChild(t)}function l(t,e){for(var n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function s(){return document.createDocumentFragment()}function c(t){return document.createElement(t)}function u(t){return document.createTextNode(t)}function d(){return document.createComment("")}function f(t,e,n,o){t.addEventListener(e,n,o)}function h(t,e,n,o){t.removeEventListener(e,n,o)}function b(t,e,n){null==n?t.removeAttribute(e):t.setAttribute(e,n)}function m(t,e){t.data=""+e}function y(t,e,n){t.style.setProperty(e,n)}function _(){return Object.create(null)}function v(t){t._lock=!0,p(t._beforecreate),p(t._oncreate),p(t._aftercreate),t._lock=!1}function g(t,e){t._handlers=_(),t._slots=_(),t._bind=e._bind,t._staged={},t.options=e,t.root=e.root||t,t.store=e.store||t.root.store,e.root||(t._beforecreate=[],t._oncreate=[],t._aftercreate=[])}function p(t){for(;t&&t.length;)t.shift()()}var k={destroy:function(e){this.destroy=t,this.fire("destroy"),this.set=t,this._fragment.d(!1!==e),this._fragment=null,this._state={}},get:function(){return this._state},fire:function(t,e){var n=t in this._handlers&&this._handlers[t].slice();if(n)for(var o=0;o<n.length;o+=1){var r=n[o];if(!r.__calling)try{r.__calling=!0,r.call(this,e)}finally{r.__calling=!1}}},on:function(t,e){var n=this._handlers[t]||(this._handlers[t]=[]);return n.push(e),{cancel:function(){var t=n.indexOf(e);~t&&n.splice(t,1)}}},set:function(t){this._set(e({},t)),this.root._lock||v(this.root)},_recompute:t,_set:function(t){var n=this._state,o={},r=!1;for(var a in t=e(this._staged,t),this._staged={},t)this._differs(t[a],n[a])&&(o[a]=r=!0);r&&(this._state=e(e({},n),t),this._recompute(o,this._state),this._bind&&this._bind(o,this._state),this._fragment&&(this.fire("state",{changed:o,current:this._state,previous:n}),this._fragment.p(o,this._state),this.fire("update",{changed:o,current:this._state,previous:n})))},_stage:function(t){e(this._staged,t)},_mount:function(t,e){this._fragment[this._fragment.i?"i":"m"](t,e||null)},_differs:function(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}};function j(t){g(this,t),this._state=e({select:"0"},t.data),this._intro=!!t.intro,this._fragment=function(t,e){var n,l,s,d,y;function _(n){t.fire("click",{color:e.color})}return{c(){n=c("div"),l=c("span"),s=u(e.label),l.className="svelte-xc3qo4",f(n,"click",_),n.className=d="Button "+e.color+" "+("1"==e.select?"select":"")+" svelte-xc3qo4",b(n,"test",e.select)},m(t,e){a(t,n,e),r(n,l),r(l,s),y=!0},p(t,o){e=o,t.label&&m(s,e.label),(t.color||t.select)&&d!==(d="Button "+e.color+" "+("1"==e.select?"select":"")+" svelte-xc3qo4")&&(n.className=d),t.select&&b(n,"test",e.select)},i(t,e){y||this.m(t,e)},o:o,d(t){t&&i(n),h(n,"click",_)}}}(this,this._state),t.target&&(this._fragment.c(),this._mount(t.target,t.anchor)),this._intro=!0}function N(n){var l,s,u,d;g(this,n),this._state=e({},n.data),this._intro=!!n.intro,this._slotted=n.slots||{},this._fragment=(l=this,this._state,d=l._slotted.default,{c(){(s=c("div")).className="Buttons svelte-mmcuhn"},m(t,e){a(t,s,e),d&&r(s,d),u=!0},p:t,i(t,e){u||this.m(t,e)},o:o,d(t){t&&i(s),d&&function(t,e){for(;t.firstChild;)e.appendChild(t.firstChild)}(s,d)}}),n.target&&(this._fragment.c(),this._mount(n.target,n.anchor)),this._intro=!0}function x(t){g(this,t),this._state=e(e({JSON:JSON},{JSONminify:!1}),t.data),this._intro=!!t.intro,this._fragment=function(t,e){var n,l,s,d,y,_,v,g,p,k,j=e.JSON.stringify(e.keyboard,"",e.JSONminify?0:2);function N(){t.set({JSONminify:d.checked})}return{c(){(n=c("h3")).textContent="JSON",l=u("\n\n"),s=c("div"),d=c("input"),y=u("\n\t"),(_=c("label")).textContent="JSON minify",v=u("\n\n\n"),g=c("pre"),p=u(j),f(d,"change",N),b(d,"type","checkbox"),_.className="svelte-vtlwtn",s.className="Rows svelte-vtlwtn"},m(t,o){a(t,n,o),a(t,l,o),a(t,s,o),r(s,d),d.checked=e.JSONminify,r(s,y),r(s,_),a(t,v,o),a(t,g,o),r(g,p),k=!0},p(t,e){t.JSONminify&&(d.checked=e.JSONminify),(t.JSON||t.keyboard||t.JSONminify)&&j!==(j=e.JSON.stringify(e.keyboard,"",e.JSONminify?0:2))&&m(p,j)},i(t,e){k||this.m(t,e)},o:o,d(t){t&&(i(n),i(l),i(s)),h(d,"change",N),t&&(i(v),i(g))}}}(this,this._state),t.target&&(this._fragment.c(),this._mount(t.target,t.anchor)),this._intro=!0}e(j.prototype,k),e(N.prototype,k),e(x.prototype,k);var O={updateColor(t){const{keyboard:e,i:n,j:o}=this.get();e.buttons[n][o].color=t,this.set({keyboard:e})},addRow(){const{keyboard:t,i:e,j:n}=this.get();let o=t.buttons.length;o<10&&(t.buttons[o]=[{action:{type:"text",payload:'{"button": "1"}',label:"Label"},color:"default"}]),this.set({keyboard:t,i:o,j:0})},addColumn(t){const{keyboard:e,i:n,j:o}=this.get();let r=e.buttons[t].length;r<4&&(e.buttons[t][r]={action:{type:"text",payload:'{"button": "1"}',label:"Label"},color:"default"}),this.set({keyboard:e,i:t,j:r})},removeButton(){const{keyboard:t,i:e,j:n}=this.get();let o=e,r=n,a=t.buttons.length,i=t.buttons[0].length;console.log(a,i),(a>1||i>1)&&(t.buttons[e].splice(n,1),0==t.buttons[e].length?(t.buttons.splice(e,1),e>0&&(o=e-1),r=t.buttons[o].length-1):n>0&&(r=n-1)),this.set({keyboard:t,i:o,j:r})}};function C(t,e,n){const o=Object.create(t);return o.color=e[n],o}function J(t){const{component:e,ctx:n}=this._svelte;e.addColumn(n.ii)}function S(t,e,n){const o=Object.create(t);return o.button=e[n],o.jj=n,o}function w(t,e,n){const o=Object.create(t);return o.buttons=e[n],o.ii=n,o}function $(t,e){var n,o={label:e.button.action.label,color:e.button.color,select:e.i==e.ii&&e.j==e.jj?"1":"0"},r=new j({root:t.root,store:t.store,data:o});return r.on("click",function(n){t.set({i:e.ii,j:e.jj})}),{c(){r._fragment.c()},m(t,e){r._mount(t,e),n=!0},p(t,n){e=n;var o={};t.keyboard&&(o.label=e.button.action.label),t.keyboard&&(o.color=e.button.color),(t.i||t.j)&&(o.select=e.i==e.ii&&e.j==e.jj?"1":"0"),r._set(o)},i(t,e){n||this.m(t,e)},o(t){n&&(r&&r._fragment.o(t),n=!1)},d(t){r.destroy(t)}}}function B(t,e){var n;return{c(){(n=c("div")).textContent="+",n._svelte={component:t,ctx:e},f(n,"click",J),n.className="button-add svelte-echfer"},m(t,e){a(t,n,e)},p(t,o){e=o,n._svelte.ctx=e},d(t){t&&i(n),h(n,"click",J)}}}function V(t,e){for(var o,f,h,b,m=e.buttons,y=[],_=0;_<m.length;_+=1)y[_]=$(t,S(e,m,_));function v(t,e,n){y[t]&&y[t].o(()=>{e&&(y[t].d(e),y[t]=null),n&&n()})}var g=new N({root:t.root,store:t.store,slots:{default:s()}}),p=e.keyboard.buttons[e.ii].length<4&&B(t,e);return{c(){o=c("div");for(var t=0;t<y.length;t+=1)y[t].c();f=d(),g._fragment.c(),h=u("\n\t\t\t"),p&&p.c(),o.className="row svelte-echfer"},m(t,e){a(t,o,e);for(var n=0;n<y.length;n+=1)y[n].i(g._slotted.default,null);r(g._slotted.default,f),g._mount(o,null),r(o,h),p&&p.m(o,null),b=!0},p(e,n){if(e.keyboard||e.i||e.j){m=n.buttons;for(var r=0;r<m.length;r+=1){const o=S(n,m,r);y[r]?y[r].p(e,o):(y[r]=$(t,o),y[r].c()),y[r].i(f.parentNode,f)}for(;r<y.length;r+=1)v(r,1)}n.keyboard.buttons[n.ii].length<4?p||((p=B(t,n)).c(),p.m(o,null)):p&&(p.d(1),p=null)},i(t,e){b||this.m(t,e)},o(t){if(!b)return;t=n(t,2);const e=n(t,(y=y.filter(Boolean)).length);for(let t=0;t<y.length;t+=1)v(t,0,e);g&&g._fragment.o(t),b=!1},d(t){t&&i(o),l(y,t),g.destroy(),p&&p.d()}}}function A(t,e){var n;function o(e){t.addRow()}return{c(){(n=c("div")).textContent="Добавить",f(n,"click",o),n.className="button-add svelte-echfer"},m(t,e){a(t,n,e)},d(t){t&&i(n),h(n,"click",o)}}}function L(t,e){var n;return{c(){(n=c("b")).textContent="Пустой текст!",n.className="note svelte-echfer",y(n,"color","#db3b3b")},m(t,e){a(t,n,e)},d(t){t&&i(n)}}}function P(t,e){var n;return{c(){(n=c("b")).textContent="Слишком много символов!",n.className="note svelte-echfer",y(n,"color","#db3b3b")},m(t,e){a(t,n,e)},d(t){t&&i(n)}}}function R(t,e){var n;return{c(){(n=c("b")).textContent="Невалидный JSON!",n.className="note svelte-echfer",y(n,"color","#db3b3b")},m(t,e){a(t,n,e)},d(t){t&&i(n)}}}function q(t,e){var n,o={label:e.keyboard.buttons[e.i][e.j].color==e.color?"X":"",color:e.color},r=new j({root:t.root,store:t.store,data:o});return r.on("click",function(e){t.updateColor(e.color)}),{c(){r._fragment.c()},m(t,e){r._mount(t,e),n=!0},p(t,e){var n={};(t.keyboard||t.i||t.j)&&(n.label=e.keyboard.buttons[e.i][e.j].color==e.color?"X":""),r._set(n)},i(t,e){n||this.m(t,e)},o(t){n&&(r&&r._fragment.o(t),n=!1)},d(t){r.destroy(t)}}}function E(t,e){var n,o={keyboard:e.keyboard},r=new x({root:t.root,store:t.store,data:o});return{c(){r._fragment.c()},m(t,e){r._mount(t,e),n=!0},p(t,e){var n={};t.keyboard&&(n.keyboard=e.keyboard),r._set(n)},i(t,e){n||this.m(t,e)},o(t){n&&(r&&r._fragment.o(t),n=!1)},d(t){r.destroy(t)}}}function T(t,e){var n,l,s,d,f;return{c(){(n=c("h3")).textContent="Ошибки",l=u("\n    "),s=c("pre"),d=u(e.errorValid)},m(t,e){a(t,n,e),a(t,l,e),a(t,s,e),r(s,d),f=!0},p(t,e){t.errorValid&&m(d,e.errorValid)},i(t,e){f||this.m(t,e)},o:o,d(t){t&&(i(n),i(l),i(s))}}}function G(t){g(this,t),this._state=e({},t.data),this._recompute({keyboard:1,i:1,j:1},this._state),this._intro=!!t.intro,this._fragment=function(t,e){for(var o,m,y,_,v,g,p,k,j,x,O,J,S,$,B,G,H,M,X,D,F,K,W,z,I,Q,U,Y,Z,tt,et,nt,ot,rt,at,it,lt,st,ct,ut,dt,ft=!1,ht=!1,bt=e.keyboard.buttons,mt=[],yt=0;yt<bt.length;yt+=1)mt[yt]=V(t,w(e,bt,yt));function _t(t,e,n){mt[t]&&mt[t].o(()=>{e&&(mt[t].d(e),mt[t]=null),n&&n()})}var vt=e.keyboard.buttons.length<10&&A(t);function gt(){ft=!0,e.keyboard.buttons[e.i][e.j].action.label=H.value,t.set({keyboard:e.keyboard,i:e.i,j:e.j}),ft=!1}var pt=""===e.keyboard.buttons[e.i][e.j].action.label&&L(),kt=e.keyboard.buttons[e.i][e.j].action.label.length>41&&P();function jt(){ht=!0,e.keyboard.buttons[e.i][e.j].action.payload=z.value,t.set({keyboard:e.keyboard,i:e.i,j:e.j}),ht=!1}var Nt=!e.validPayload&&R(),xt=["primary","default","negative","positive"],Ot=[];for(yt=0;yt<xt.length;yt+=1)Ot[yt]=q(t,C(e,xt,yt));function Ct(t,e,n){Ot[t]&&Ot[t].o(()=>{e&&(Ot[t].d(e),Ot[t]=null),n&&n()})}var Jt=new N({root:t.root,store:t.store,slots:{default:s()}});function St(e){t.removeButton()}function wt(){e.keyboard.one_time=at.checked,t.set({keyboard:e.keyboard})}var $t=[T,E],Bt=[];function Vt(t){return t.errorValid?0:1}return ct=Vt(e),ut=Bt[ct]=$t[ct](t,e),{c(){o=c("div"),(m=c("h1")).textContent="Генератор клавиатуры для VK",y=u("\n\t\n  "),(_=c("p")).innerHTML='\n\t\t\t\t\tГенерирует <a href="https://vk.com/dev/bots_docs_3">клавиатуру</a> для ботов. \n\t\t\t    Проверить клавиатуру можно отправив JSON <a href="https://vk.com/im?sel=-174472256">боту</a>.\n\t\t\t\t',v=u("\n  "),(g=c("p")).innerHTML='<a href="https://github.com/severecloud/vk-keyboard">Github</a>',p=u("\n\n  "),(k=c("h3")).textContent="Клавиатура",j=u("\n\n\t"),x=c("div");for(var t=0;t<mt.length;t+=1)mt[t].c();for(O=u(" \n    "),vt&&vt.c(),J=u("\n\n    "),S=c("div"),$=c("div"),(B=c("label")).textContent="Текст",G=u("\n        "),H=c("input"),M=u("\n        "),pt&&pt.c(),X=u("\n        "),kt&&kt.c(),D=u("\n\n      "),F=c("div"),(K=c("label")).textContent="Полезная нагрузка",W=u("\n        "),z=c("input"),I=u(" \n        "),Nt&&Nt.c(),Q=u("\n\n      "),U=c("div"),(Y=c("label")).textContent="Цвет",Z=u("\n        "),t=0;t<Ot.length;t+=1)Ot[t].c();tt=d(),Jt._fragment.c(),et=u("\n\n      "),(nt=c("div")).textContent="Удалить",ot=u("\n\n    "),rt=c("div"),at=c("input"),it=u("\n      "),(lt=c("label")).textContent="скрывать клавиатуру сразу",st=u("\n\n  "),ut.c(),B.className="svelte-echfer",f(H,"input",gt),b(H,"type","text"),$.className="block-item svelte-echfer",K.className="svelte-echfer",f(z,"input",jt),b(z,"type","text"),F.className="block-item svelte-echfer",Y.className="svelte-echfer",U.className="block-item svelte-echfer",f(nt,"click",St),nt.className="button-remove svelte-echfer",S.className="border svelte-echfer",f(at,"change",wt),b(at,"type","checkbox"),lt.className="svelte-echfer",rt.className="one-time svelte-echfer",x.className="buttons-main svelte-echfer",o.className="main svelte-echfer"},m(t,n){a(t,o,n),r(o,m),r(o,y),r(o,_),r(o,v),r(o,g),r(o,p),r(o,k),r(o,j),r(o,x);for(var i=0;i<mt.length;i+=1)mt[i].i(x,null);for(r(x,O),vt&&vt.m(x,null),r(x,J),r(x,S),r(S,$),r($,B),r($,G),r($,H),H.value=e.keyboard.buttons[e.i][e.j].action.label,r($,M),pt&&pt.m($,null),r($,X),kt&&kt.m($,null),r(S,D),r(S,F),r(F,K),r(F,W),r(F,z),z.value=e.keyboard.buttons[e.i][e.j].action.payload,r(F,I),Nt&&Nt.m(F,null),r(S,Q),r(S,U),r(U,Y),r(U,Z),i=0;i<Ot.length;i+=1)Ot[i].i(Jt._slotted.default,null);r(Jt._slotted.default,tt),Jt._mount(U,null),r(S,et),r(S,nt),r(x,ot),r(x,rt),r(rt,at),at.checked=e.keyboard.one_time,r(rt,it),r(rt,lt),r(o,st),Bt[ct].m(o,null),dt=!0},p(n,r){if(e=r,n.keyboard||n.i||n.j){bt=e.keyboard.buttons;for(var a=0;a<bt.length;a+=1){const o=w(e,bt,a);mt[a]?mt[a].p(n,o):(mt[a]=V(t,o),mt[a].c()),mt[a].i(x,O)}for(;a<mt.length;a+=1)_t(a,1)}if(e.keyboard.buttons.length<10?vt||((vt=A(t)).c(),vt.m(x,J)):vt&&(vt.d(1),vt=null),!ft&&(n.keyboard||n.i||n.j)&&(H.value=e.keyboard.buttons[e.i][e.j].action.label),""===e.keyboard.buttons[e.i][e.j].action.label?pt||((pt=L()).c(),pt.m($,X)):pt&&(pt.d(1),pt=null),e.keyboard.buttons[e.i][e.j].action.label.length>41?kt||((kt=P()).c(),kt.m($,null)):kt&&(kt.d(1),kt=null),!ht&&(n.keyboard||n.i||n.j)&&(z.value=e.keyboard.buttons[e.i][e.j].action.payload),e.validPayload?Nt&&(Nt.d(1),Nt=null):Nt||((Nt=R()).c(),Nt.m(F,null)),n.keyboard||n.i||n.j){for(xt=["primary","default","negative","positive"],a=0;a<xt.length;a+=1){const o=C(e,xt,a);Ot[a]?Ot[a].p(n,o):(Ot[a]=q(t,o),Ot[a].c()),Ot[a].i(tt.parentNode,tt)}for(;a<Ot.length;a+=1)Ct(a,1)}n.keyboard&&(at.checked=e.keyboard.one_time);var i=ct;(ct=Vt(e))===i?Bt[ct].p(n,e):(ut.o(function(){Bt[i].d(1),Bt[i]=null}),(ut=Bt[ct])||(ut=Bt[ct]=$t[ct](t,e)).c(),ut.m(o,null))},i(t,e){dt||this.m(t,e)},o(t){if(!dt)return;t=n(t,4);const e=n(t,(mt=mt.filter(Boolean)).length);for(let t=0;t<mt.length;t+=1)_t(t,0,e);const o=n(t,(Ot=Ot.filter(Boolean)).length);for(let t=0;t<Ot.length;t+=1)Ct(t,0,o);Jt&&Jt._fragment.o(t),ut?ut.o(t):t(),dt=!1},d(t){t&&i(o),l(mt,t),vt&&vt.d(),h(H,"input",gt),pt&&pt.d(),kt&&kt.d(),h(z,"input",jt),Nt&&Nt.d(),l(Ot,t),Jt.destroy(),h(nt,"click",St),h(at,"change",wt),Bt[ct].d()}}}(this,this._state),t.target&&(this._fragment.c(),this._mount(t.target,t.anchor),v(this)),this._intro=!0}return e(G.prototype,k),e(G.prototype,O),G.prototype._recompute=function(t,e){(t.keyboard||t.i||t.j)&&this._differs(e.validPayload,e.validPayload=function({keyboard:t,i:e,j:n}){let o,r=t.buttons[e][n].action.payload;try{o=JSON.parse(r)}catch(t){return!1}return(t=>t instanceof Object&&!Array.isArray(t))(o)&&0!=Object.keys(o).length&&r.length<256}(e))&&(t.validPayload=!0),t.keyboard&&this._differs(e.errorValid,e.errorValid=function({keyboard:t}){let e="";for(let n=0;n<t.buttons.length;n++){const o=t.buttons[n];for(let t=0;t<o.length;t++){const r=o[t];""==r.action.label&&(e+=`${n+1}:${t+1} пустой текст\n`),r.action.label.length>41&&(e+=`${n+1}:${t+1} больше 40 символов в тексте\n`);let a,i=t=>t instanceof Object&&!Array.isArray(t),l=r.action.payload;try{i(a=JSON.parse(l))||(e+=`${n+1}:${t+1} требуется объект в json вида {"button": 1}\n`),0==Object.keys(a).length&&(e+=`${n+1}:${t+1} пустой объект в json\n`),l.length>255&&(e+=`${n+1}:${t+1} больше 255 символов в json\n`)}catch(o){e+=`${n+1}:${t+1} невалидный json\n`}}}return e}(e))&&(t.errorValid=!0)},new G({target:document.body,data:{keyboard:{one_time:!1,buttons:[[{action:{type:"text",payload:'{"button": "1"}',label:"Red"},color:"negative"},{action:{type:"text",payload:'{"button": "2"}',label:"Green"},color:"positive"}],[{action:{type:"text",payload:'{"button": "3"}',label:"White"},color:"default"},{action:{type:"text",payload:'{"button": "4"}',label:"Blue"},color:"primary"}]]},i:0,j:0,errorValid:""}})}();
//# sourceMappingURL=bundle.js.map
